\doxysection{C\+:/\+Users/leoku/\+One\+Drive/\+Personal\+\_\+\+Coding\+\_\+\+Projects/\+Zest\+Code/src/system/dev/vfs.c File Reference}
\hypertarget{vfs_8c}{}\label{vfs_8c}\index{C:/Users/leoku/OneDrive/Personal\_Coding\_Projects/ZestCode/src/system/dev/vfs.c@{C:/Users/leoku/OneDrive/Personal\_Coding\_Projects/ZestCode/src/system/dev/vfs.c}}
{\ttfamily \#include $<$errno.\+h$>$}\newline
{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include "{}common/gid.\+h"{}}\newline
{\ttfamily \#include "{}common/string.\+h"{}}\newline
{\ttfamily \#include "{}kapi.\+h"{}}\newline
{\ttfamily \#include "{}system/dev/dev.\+h"{}}\newline
{\ttfamily \#include "{}system/dev/ser.\+h"{}}\newline
{\ttfamily \#include "{}system/dev/usd.\+h"{}}\newline
{\ttfamily \#include "{}system/dev/vfs.\+h"{}}\newline
{\ttfamily \#include "{}v5\+\_\+api.\+h"{}}\newline
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{vfs_8c_a3123b802ea2dcf9193d4961b905dfe67}\label{vfs_8c_a3123b802ea2dcf9193d4961b905dfe67} 
\#define {\bfseries MAX\+\_\+\+FILELEN}~128
\item 
\Hypertarget{vfs_8c_a45fea697baeb85c0993f183a7badc9d1}\label{vfs_8c_a45fea697baeb85c0993f183a7badc9d1} 
\#define {\bfseries MAX\+\_\+\+FILES\+\_\+\+OPEN}~31
\item 
\Hypertarget{vfs_8c_a045c29ea59c3d0939b907f695fe5ec51}\label{vfs_8c_a045c29ea59c3d0939b907f695fe5ec51} 
\#define {\bfseries RESERVED\+\_\+\+FILENOS}~4
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{vfs_8c_aaac6536c096924ca918fba99e977ffef}\label{vfs_8c_aaac6536c096924ca918fba99e977ffef} 
void {\bfseries vfs\+\_\+initialize} (void)
\item 
\Hypertarget{vfs_8c_aa4bd4045e6ecf897c09e0a9a0f289e2c}\label{vfs_8c_aa4bd4045e6ecf897c09e0a9a0f289e2c} 
int {\bfseries vfs\+\_\+add\+\_\+entry\+\_\+r} (struct \+\_\+reent \texorpdfstring{$\ast$}{*}r, struct \mbox{\hyperlink{structfs__driver}{fs\+\_\+driver}} const \texorpdfstring{$\ast$}{*}const driver, void \texorpdfstring{$\ast$}{*}arg)
\item 
\Hypertarget{vfs_8c_a7b95dec382e104eeb85e6b74c41bbce4}\label{vfs_8c_a7b95dec382e104eeb85e6b74c41bbce4} 
int {\bfseries vfs\+\_\+update\+\_\+entry} (int file, struct \mbox{\hyperlink{structfs__driver}{fs\+\_\+driver}} const \texorpdfstring{$\ast$}{*}const driver, void \texorpdfstring{$\ast$}{*}arg)
\item 
\Hypertarget{vfs_8c_a8bacf6457e9da2611b9ef0ea7d1d851b}\label{vfs_8c_a8bacf6457e9da2611b9ef0ea7d1d851b} 
int {\bfseries \+\_\+open} (const char \texorpdfstring{$\ast$}{*}file, int flags, int mode)
\item 
\Hypertarget{vfs_8c_ad3bfdd653c87057b76024da1e32d0dda}\label{vfs_8c_ad3bfdd653c87057b76024da1e32d0dda} 
ssize\+\_\+t {\bfseries \+\_\+write} (int file, const void \texorpdfstring{$\ast$}{*}buf, size\+\_\+t len)
\item 
\Hypertarget{vfs_8c_a661eaeb4eceab85ede6fad857a087f82}\label{vfs_8c_a661eaeb4eceab85ede6fad857a087f82} 
ssize\+\_\+t {\bfseries \+\_\+read} (int file, void \texorpdfstring{$\ast$}{*}buf, size\+\_\+t len)
\item 
\Hypertarget{vfs_8c_a5aab5e2acfd600e3667dc915a2bbc7cb}\label{vfs_8c_a5aab5e2acfd600e3667dc915a2bbc7cb} 
int {\bfseries \+\_\+close} (int file)
\item 
\Hypertarget{vfs_8c_a41eef54307912a82d20e71c3d47315aa}\label{vfs_8c_a41eef54307912a82d20e71c3d47315aa} 
int {\bfseries \+\_\+fstat} (int file, struct stat \texorpdfstring{$\ast$}{*}st)
\item 
\Hypertarget{vfs_8c_a91f68cb770f531b381656d78e0c92912}\label{vfs_8c_a91f68cb770f531b381656d78e0c92912} 
off\+\_\+t {\bfseries \+\_\+lseek} (int file, off\+\_\+t ptr, int dir)
\item 
\Hypertarget{vfs_8c_ad3134a3dc296622b8d1c5456e481505b}\label{vfs_8c_ad3134a3dc296622b8d1c5456e481505b} 
int {\bfseries \+\_\+isatty} (int file)
\item 
int32\+\_\+t \mbox{\hyperlink{group__apix_ga8287028141d5265105a25d899280a8e1}{fdctl}} (int file, const uint32\+\_\+t action, void \texorpdfstring{$\ast$}{*}const extra\+\_\+arg)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Virtual File System

VFS is responsible for maintaining the global file table and routing all basic I/O to the appropriate driver. There are three drivers implemented, ser, dev, and usd which correspond to the serial driver, generic smart port communication, and micro\+SD card, respectively.

VFS implements all of the I/O newlib stubs like open/read/write and delegates them to the file\textquotesingle{}s driver. Drivers don\textquotesingle{}t actually have any knowledge of the fileno. A file number maps to a driver and driver argument, which would be whatever metadata the driver needs to open the file

Copyright (c) 2017-\/2021, Purdue University ACM SIGBots All rights reserved.

This Source Code Form is subject to the terms of the Mozilla Public License, v. 2.\+0. If a copy of the MPL was not distributed with this file, You can obtain one at \href{http://mozilla.org/MPL/2.0/}{\texttt{ http\+://mozilla.\+org/\+MPL/2.\+0/}}. 